# Factory method

<b>Фабричний метод</b> - це патерн в програмуванні, що дозволяє породжувати однотипні об'єкти через загальний інтерфейс властивостей і/або методів. Він вирішує проблему створення нових об'єктів через ключове слово new, використовуючи при цьому окремий фабричний метод.

Він буде корисний у випадку якщо
  - ще не відомо які типи і залежності об'єктів будуть використовуватись у коді
  - потрібно виділити код створення об'єктів в одне місце, що спрощує підтримку коду

Патерн спрощує та структуризує створення нових об'єктів до клієнтського коду, а також реалізує один з принципів SOLID, а саме принцип відкритості-закритості тим, що він є відритим до розширення (модифікаця фабрики), а також закритий для змін "зверху" (зі сторони клієнтського коду).

Нижче буде наведено кілька прикладів фабрик в typescript-проекті

## Приклад використання фабрики в ООП-стилі

```ts
// Створюємо загальний інтерфейс для об'єктів
interface IDevice {
  name: string
  deliver: () => void
}

// Створюємо клас фабрики, в якому описана типову реалізацію
abstract class FabricDevice {
  protected abstract createDevice (): IDevice

  deliverDevice () {
    const device = this.createDevice()

    device.deliver()
  }
}

// Додаємо новий продукт Комп'ютер, що імплементує інтерфейс IDevice
class Computer implements IDevice {
  name = 'Computer'
  deliver () {
    console.log(`Delivering ${this.name}, will arrive in 2 weeks`)
  }
}

// Додаємо новий продукт Ноутбук, що імплементує інтерфейс IDevice
class Laptop implements IDevice {
  name = 'Laptop'
  deliver () {
    console.log(`Delivering ${this.name}, will arrive in 4 days`)
  }
}


// Створюємо фабрику для створення Комп'ютерів, наслідуючи основний клас фабрик,
// де перевизначаємо метод createDevice
class FabricComputer extends FabricDevice {
  protected createDevice(): IDevice {
    return new Computer()
  }
}

// Створюємо фабрику для створення Ноутбуків
class FabricLaptop extends FabricDevice {
  protected createDevice(): IDevice {
    return new Laptop()
  }
}

let deviceFabric: FabricDevice

// Випадковим чином присвоюємо фабрику або Комп'ютерів, або Ноутбуків до фабрики deviceFabric.
// Це просто приклад, у реальних випадках треба вказувати більш очевидні і передбачувані умови для обирання фабрики
if (Math.random() > 0.5) {
  deviceFabric = new FabricComputer()
} else {
  deviceFabric = new FabricLaptop()
}

// Викликаємо загальний метод доставки пристрою
deviceFabric.deliverDevice()
```

## Приклад використання фабрики у функціональному стилі.

```ts
// Оголошення функції createCar, що повертає функцію getDetail 
function createCar(mark: string, model :string, year: number) {
  // Виводимо загальну інформацію про автомобіль
  function getDetails() {
    return `Mark:${mark};\nModel: ${model};\nIssued at: ${year};\n`;
  }

  // Лагодимо автомобіль, і повертаємо успішене повідомлення через час,
  // що залежить року випуску автомобіля
  function fix () {
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve(`The car ${mark} ${model} has been fixed!`)
      }, year > 2015 ? 1000 : year > 1999 ? 3000 : 5000)
    })
  }
  
  return { getDetails, fix };
}


// Створюємо 2 екзепляри автомобіля, використовуючи фабрику createCar
const car1 = createCar('Mercedes-Benz', 'E220', 2010);
const car2 = createCar('Honda', 'Civic', 2021);

// Логуємо деталі
console.log(car1.getDetails());
console.log(car2.getDetails());

// Лагодимо автомобіль та виводимо успішне повідомленя по завершенні
car1.fix().then(msg => console.log(msg))
```

## Переваги

- Інкапсулює створення об’єктів і полегшує підтримку, зміну та розширення коду.
- Відокремлює створення об’єкта від використання об’єкта, що робить код більш гнучким і тестованим.
- Дозволяє створювати об’єкти, не відкриваючи деталі їх створення клієнтcького коду .
- Дозволяє використовувати поліморфізм шляхом створення об’єктів через загальний інтерфейс або абстрактний клас.

## Недоліки

- Може внести додаткову складність у код, особливо якщо кількість продуктів і варіацій продуктів велика.
- Для впровадження може знадобитися додатковий шаблонний код, особливо якщо використовується строгий підхід на основі інтерфейсу.
- Може бути надмірним для невеликих простих програм із обмеженими вимогами до створення об’єктів.
- Може вимагати додаткового часу та зусиль для правильного проектування та впровадження, особливо для недосвідчених розробників.


Таким чином, патерн Фабрика може запропонувати кілька переваг, таких як інкапсуляція створення об’єкта, сприяння гнучкості та повторного використання коду, а також абстрагування деталей реалізації. Однак це також може ускладнювати, перешкоджати розширюваності та бути складним для тестування. Тому, вирішуючи, чи використовувати шаблон Factory, важливо враховувати конкретні вимоги та обмеження системи та визначити, чи переваги переважають потенційні недоліки.